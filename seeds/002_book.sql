-- =====================================================
-- 6. BOOKS - GENERATE 60 BOOKS WITH PROPER SCHEMA
-- =====================================================

-- Helper function to generate realistic book data
DO $$
DECLARE
    book_data RECORD;
    book_id UUID;
    book_num INT;
BEGIN
    -- Define book data array (simplified)
    FOR book_data IN 
        SELECT * FROM (VALUES
            (1, 'Mắt Biếc', 'mat-biec', '9786041140400', '50000000-0000-0000-0000-000000000001', '40000000-0000-0000-0000-000000000001', '30000000-0000-0000-0000-000000000006', 95000, 120000, 65000, 'Tác phẩm nổi tiếng của Nguyễn Nhật Ánh về tình yêu tuổi học trò', 280, 'vi', 2018, 'paperback', '20.5 x 14 x 1.5 cm', 320, true, true),
            (2, 'Tôi Thấy Hoa Vàng Trên Cỏ Xanh', 'toi-thay-hoa-vang-tren-co-xanh', '9786041079977', '50000000-0000-0000-0000-000000000001', '40000000-0000-0000-0000-000000000001', '30000000-0000-0000-0000-000000000006', 110000, 135000, 75000, 'Truyện về tuổi thơ dữ dội và trữ tình', 368, 'vi', 2017, 'paperback', '20.5 x 14 x 2 cm', 380, true, true),
            (3, 'Tắt Đèn', 'tat-den', '9786041008892', '50000000-0000-0000-0000-000000000002', '40000000-0000-0000-0000-000000000003', '30000000-0000-0000-0000-000000000006', 65000, 80000, 45000, 'Tác phẩm kinh điển của Ngô Tất Tố', 248, 'vi', 2016, 'paperback', '19 x 13 x 1.2 cm', 250, true, false),
            (4, 'Dế Mèn Phiêu Lưu Ký', 'de-men-phieu-luu-ky', '9786041001985', '50000000-0000-0000-0000-000000000003', '40000000-0000-0000-0000-000000000002', '30000000-0000-0000-0000-000000000006', 75000, 90000, 50000, 'Truyện thiếu nhi nổi tiếng của Tô Hoài', 196, 'vi', 2015, 'paperback', '20 x 14 x 1 cm', 200, true, true),
            (5, 'Chí Phèo', 'chi-pheo', '9786041007543', '50000000-0000-0000-0000-000000000004', '40000000-0000-0000-0000-000000000003', '30000000-0000-0000-0000-000000000007', 45000, 55000, 30000, 'Truyện ngắn nổi tiếng của Nam Cao', 128, 'vi', 2016, 'paperback', '19 x 13 x 0.8 cm', 130, true, false),
            (6, 'Norwegian Wood', 'norwegian-wood', '9780375704024', '50000000-0000-0000-0000-000000000006', '40000000-0000-0000-0000-000000000005', '30000000-0000-0000-0000-000000000006', 185000, 220000, 130000, 'Tình yêu và mất mát của Haruki Murakami', 296, 'en', 2018, 'paperback', '21 x 14 x 1.5 cm', 340, true, true),
            (7, 'Kafka on the Shore', 'kafka-on-the-shore', '9781400079278', '50000000-0000-0000-0000-000000000006', '40000000-0000-0000-0000-000000000005', '30000000-0000-0000-0000-000000000006', 210000, 250000, 150000, 'Tiểu thuyết siêu thực của Murakami', 480, 'en', 2019, 'paperback', '21 x 14 x 2.5 cm', 520, true, false),
            (8, 'The Alchemist', 'the-alchemist', '9780061122415', '50000000-0000-0000-0000-000000000008', '40000000-0000-0000-0000-000000000005', '30000000-0000-0000-0000-000000000006', 165000, 195000, 115000, 'Hành trình tìm kiếm kho báu của Paulo Coelho', 208, 'en', 2017, 'paperback', '20 x 13 x 1.2 cm', 220, true, true),
            (9, 'Harry Potter Stone', 'harry-potter-sorcerers-stone', '9780590353427', '50000000-0000-0000-0000-000000000007', '40000000-0000-0000-0000-000000000013', '30000000-0000-0000-0000-000000000006', 195000, 230000, 140000, 'Cuốn đầu tiên của series Harry Potter', 320, 'en', 2018, 'hardcover', '22 x 15 x 2.5 cm', 480, true, true),
            (10, 'Truyện Kiều', 'truyen-kieu', '9786041001541', '50000000-0000-0000-0000-000000000005', '40000000-0000-0000-0000-000000000003', '30000000-0000-0000-0000-000000000008', 85000, 100000, 60000, 'Tác phẩm bất hủ của Nguyễn Du', 256, 'vi', 2015, 'paperback', '20 x 14 x 1.5 cm', 280, true, true),
            (11, 'Rich Dad Poor Dad', 'rich-dad-poor-dad', '9781612680194', '50000000-0000-0000-0000-000000000010', '40000000-0000-0000-0000-000000000004', '30000000-0000-0000-0000-000000000010', 145000, 175000, 100000, 'Cha giàu cha nghèo - Bí quyết làm giàu', 336, 'en', 2017, 'paperback', '21 x 14 x 1.8 cm', 360, true, true),
            (12, 'The Lean Startup', 'the-lean-startup', '9780307887894', '50000000-0000-0000-0000-000000000016', '40000000-0000-0000-0000-000000000011', '30000000-0000-0000-0000-000000000010', 195000, 230000, 140000, 'Phương pháp khởi nghiệp tinh gọn', 336, 'en', 2018, 'paperback', '21 x 14 x 1.8 cm', 360, true, true),
            (13, 'Zero to One', 'zero-to-one', '9780804139298', '50000000-0000-0000-0000-000000000016', '40000000-0000-0000-0000-000000000011', '30000000-0000-0000-0000-000000000010', 185000, 220000, 130000, 'Từ 0 đến 1 - Bí quyết startup', 224, 'en', 2019, 'paperback', '21 x 14 x 1.2 cm', 240, true, false),
            (14, 'Purple Cow', 'purple-cow', '9781591843177', '50000000-0000-0000-0000-000000000017', '40000000-0000-0000-0000-000000000011', '30000000-0000-0000-0000-000000000011', 125000, 150000, 90000, 'Marketing đột phá - Con bò tím', 160, 'en', 2017, 'paperback', '20 x 13 x 1 cm', 180, true, false),
            (15, 'Start with Why', 'start-with-why', '9781591846444', '50000000-0000-0000-0000-000000000012', '40000000-0000-0000-0000-000000000011', '30000000-0000-0000-0000-000000000012', 165000, 195000, 115000, 'Lãnh đạo cần bắt đầu từ lý do', 256, 'en', 2018, 'paperback', '21 x 14 x 1.4 cm', 280, true, true),
            (16, 'Good to Great', 'good-to-great', '9780066620992', '50000000-0000-0000-0000-000000000012', '40000000-0000-0000-0000-000000000012', '30000000-0000-0000-0000-000000000012', 175000, 210000, 125000, 'Từ tốt đến vĩ đại', 320, 'en', 2017, 'paperback', '21 x 14 x 1.8 cm', 350, true, false),
            (17, 'The 4-Hour Workweek', '4-hour-workweek', '9780307465351', '50000000-0000-0000-0000-000000000016', '40000000-0000-0000-0000-000000000011', '30000000-0000-0000-0000-000000000010', 185000, 220000, 130000, 'Làm việc 4 giờ mỗi tuần', 416, 'en', 2018, 'paperback', '21 x 14 x 2.2 cm', 450, true, false),
            (18, 'The E-Myth Revisited', 'e-myth-revisited', '9780887307287', '50000000-0000-0000-0000-000000000016', '40000000-0000-0000-0000-000000000012', '30000000-0000-0000-0000-000000000012', 155000, 185000, 110000, 'Huyền thoại về doanh nghiệp', 288, 'en', 2017, 'paperback', '21 x 14 x 1.5 cm', 310, true, false),
            (19, 'Thinking Fast Slow', 'thinking-fast-and-slow', '9780374533557', '50000000-0000-0000-0000-000000000019', '40000000-0000-0000-0000-000000000011', '30000000-0000-0000-0000-000000000014', 215000, 255000, 155000, 'Tư duy nhanh và chậm', 499, 'en', 2019, 'paperback', '22 x 15 x 2.8 cm', 550, true, true),
            (20, 'Intelligent Investor', 'intelligent-investor', '9780060555665', '50000000-0000-0000-0000-000000000019', '40000000-0000-0000-0000-000000000012', '30000000-0000-0000-0000-000000000013', 235000, 280000, 170000, 'Nhà đầu tư thông minh', 640, 'en', 2018, 'hardcover', '23 x 16 x 3.5 cm', 720, true, false),
            (21, 'How to Win Friends', 'how-to-win-friends', '9780671027032', '50000000-0000-0000-0000-000000000009', '40000000-0000-0000-0000-000000000012', '30000000-0000-0000-0000-000000000015', 125000, 150000, 90000, 'Đắc nhân tâm', 288, 'en', 2017, 'paperback', '20 x 13 x 1.5 cm', 310, true, true),
            (22, '7 Habits Effective', '7-habits-effective-people', '9781982137274', '50000000-0000-0000-0000-000000000018', '40000000-0000-0000-0000-000000000012', '30000000-0000-0000-0000-000000000014', 195000, 230000, 140000, '7 thói quen hiệu quả', 464, 'en', 2018, 'paperback', '22 x 15 x 2.5 cm', 500, true, true),
            (23, 'Atomic Habits', 'atomic-habits', '9780735211292', '50000000-0000-0000-0000-000000000018', '40000000-0000-0000-0000-000000000012', '30000000-0000-0000-0000-000000000014', 175000, 210000, 125000, 'Thói quen nguyên tử', 320, 'en', 2019, 'paperback', '21 x 14 x 1.8 cm', 350, true, true),
            (24, 'Deep Work', 'deep-work', '9781455586691', '50000000-0000-0000-0000-000000000018', '40000000-0000-0000-0000-000000000011', '30000000-0000-0000-0000-000000000014', 165000, 195000, 115000, 'Làm việc chuyên sâu', 304, 'en', 2018, 'paperback', '21 x 14 x 1.6 cm', 330, true, false),
            (25, 'Sapiens', 'sapiens', '9780062316097', '50000000-0000-0000-0000-000000000020', '40000000-0000-0000-0000-000000000012', '30000000-0000-0000-0000-000000000014', 215000, 255000, 155000, 'Lược sử loài người', 464, 'en', 2018, 'paperback', '22 x 15 x 2.5 cm', 510, true, true),
            (26, 'Outliers', 'outliers', '9780316017930', '50000000-0000-0000-0000-000000000011', '40000000-0000-0000-0000-000000000012', '30000000-0000-0000-0000-000000000014', 185000, 220000, 130000, 'Những người xuất chúng', 336, 'en', 2017, 'paperback', '21 x 14 x 1.8 cm', 360, true, false),
            (27, 'Power of Now', 'power-of-now', '9781577314806', '50000000-0000-0000-0000-000000000018', '40000000-0000-0000-0000-000000000012', '30000000-0000-0000-0000-000000000016', 145000, 175000, 100000, 'Sức mạnh của hiện tại', 236, 'en', 2017, 'paperback', '20 x 13 x 1.3 cm', 250, true, false),
            (28, 'Mindset', 'mindset', '9780345472328', '50000000-0000-0000-0000-000000000019', '40000000-0000-0000-0000-000000000011', '30000000-0000-0000-0000-000000000014', 165000, 195000, 115000, 'Tư duy phát triển', 320, 'en', 2018, 'paperback', '21 x 14 x 1.8 cm', 340, true, false),
            (29, 'Grit', 'grit', '9781501111105', '50000000-0000-0000-0000-000000000019', '40000000-0000-0000-0000-000000000012', '30000000-0000-0000-0000-000000000014', 175000, 210000, 125000, 'Nghị lực - Sức mạnh đam mê', 352, 'en', 2019, 'paperback', '21 x 14 x 1.9 cm', 380, true, false),
            (30, 'Subtle Art', 'subtle-art-not-giving', '9780062457714', '50000000-0000-0000-0000-000000000018', '40000000-0000-0000-0000-000000000012', '30000000-0000-0000-0000-000000000014', 155000, 185000, 110000, 'Nghệ thuật tinh tế việc đếch quan tâm', 224, 'en', 2018, 'paperback', '20 x 13 x 1.2 cm', 240, true, true),
            (31, 'Doraemon Tập 1', 'doraemon-tap-1', '9786041001116', '50000000-0000-0000-0000-000000000003', '40000000-0000-0000-0000-000000000002', '30000000-0000-0000-0000-000000000017', 25000, 30000, 18000, 'Truyện tranh Doraemon', 196, 'vi', 2015, 'paperback', '18 x 13 x 1 cm', 180, true, true),
            (32, 'Doraemon Tập 2', 'doraemon-tap-2', '9786041001123', '50000000-0000-0000-0000-000000000003', '40000000-0000-0000-0000-000000000002', '30000000-0000-0000-0000-000000000017', 25000, 30000, 18000, 'Truyện tranh Doraemon', 196, 'vi', 2015, 'paperback', '18 x 13 x 1 cm', 180, true, true),
            (33, 'Conan Tập 1', 'conan-tap-1', '9786041002541', '50000000-0000-0000-0000-000000000003', '40000000-0000-0000-0000-000000000002', '30000000-0000-0000-0000-000000000017', 25000, 30000, 18000, 'Thám tử lừng danh Conan', 184, 'vi', 2015, 'paperback', '18 x 13 x 1 cm', 170, true, true),
            (34, 'Conan Tập 2', 'conan-tap-2', '9786041002558', '50000000-0000-0000-0000-000000000003', '40000000-0000-0000-0000-000000000002', '30000000-0000-0000-0000-000000000017', 25000, 30000, 18000, 'Thám tử lừng danh Conan', 184, 'vi', 2015, 'paperback', '18 x 13 x 1 cm', 170, true, false),
            (35, 'Tô Màu Động Vật', 'sach-to-mau-dong-vat', '9786041003845', '50000000-0000-0000-0000-000000000003', '40000000-0000-0000-0000-000000000002', '30000000-0000-0000-0000-000000000018', 35000, 42000, 25000, 'Sách tô màu cho bé', 48, 'vi', 2016, 'paperback', '21 x 21 x 0.3 cm', 100, true, false),
            (36, 'Tô Màu Phương Tiện', 'sach-to-mau-phuong-tien', '9786041003852', '50000000-0000-0000-0000-000000000003', '40000000-0000-0000-0000-000000000002', '30000000-0000-0000-0000-000000000018', 35000, 42000, 25000, 'Sách tô màu phương tiện', 48, 'vi', 2016, 'paperback', '21 x 21 x 0.3 cm', 100, true, false),
            (37, 'Cổ Tích Việt Nam', 'truyen-co-tich-viet-nam', '9786041004231', '50000000-0000-0000-0000-000000000003', '40000000-0000-0000-0000-000000000002', '30000000-0000-0000-0000-000000000019', 65000, 78000, 45000, 'Tuyển tập truyện cổ tích VN', 256, 'vi', 2016, 'paperback', '20 x 14 x 1.4 cm', 280, true, true),
            (38, 'Cổ Tích Thế Giới', 'truyen-co-tich-the-gioi', '9786041004248', '50000000-0000-0000-0000-000000000003', '40000000-0000-0000-0000-000000000002', '30000000-0000-0000-0000-000000000019', 75000, 90000, 52000, 'Truyện cổ tích nổi tiếng', 288, 'vi', 2016, 'paperback', '20 x 14 x 1.6 cm', 310, true, false),
            (39, 'Nhật Ký Của Mẹ', 'nhat-ky-cua-me', '9786041005123', '50000000-0000-0000-0000-000000000001', '40000000-0000-0000-0000-000000000002', '30000000-0000-0000-0000-000000000017', 55000, 66000, 38000, 'Truyện tranh cảm động', 160, 'vi', 2017, 'paperback', '19 x 13 x 0.9 cm', 170, true, true),
            (40, 'Cô Bé Quàng Khăn', 'co-be-quang-khan-do', '9786041005789', '50000000-0000-0000-0000-000000000003', '40000000-0000-0000-0000-000000000002', '30000000-0000-0000-0000-000000000019', 45000, 54000, 32000, 'Truyện cổ tích kinh điển', 96, 'vi', 2017, 'paperback', '19 x 13 x 0.5 cm', 100, true, false),
            (41, 'Clean Code', 'clean-code', '9780132350884', '50000000-0000-0000-0000-000000000013', '40000000-0000-0000-0000-000000000010', '30000000-0000-0000-0000-000000000020', 385000, 450000, 280000, 'Agile Software Craftsmanship', 464, 'en', 2018, 'paperback', '23 x 16 x 2.5 cm', 550, true, true),
            (42, 'Pragmatic Programmer', 'pragmatic-programmer', '9780201616224', '50000000-0000-0000-0000-000000000013', '40000000-0000-0000-0000-000000000010', '30000000-0000-0000-0000-000000000020', 365000, 425000, 265000, 'Journeyman to Master', 352, 'en', 2018, 'paperback', '23 x 16 x 2 cm', 420, true, false),
            (43, 'Design Patterns', 'design-patterns', '9780201633610', '50000000-0000-0000-0000-000000000013', '40000000-0000-0000-0000-000000000010', '30000000-0000-0000-0000-000000000020', 395000, 460000, 290000, 'Reusable OO Software', 416, 'en', 2017, 'hardcover', '24 x 17 x 2.3 cm', 600, true, false),
            (44, 'Refactoring', 'refactoring', '9780134757599', '50000000-0000-0000-0000-000000000015', '40000000-0000-0000-0000-000000000010', '30000000-0000-0000-0000-000000000020', 415000, 485000, 305000, 'Improving Code Design', 448, 'en', 2019, 'paperback', '23 x 16 x 2.4 cm', 530, true, true),
            (45, 'Code Complete', 'code-complete', '9780735619678', '50000000-0000-0000-0000-000000000013', '40000000-0000-0000-0000-000000000010', '30000000-0000-0000-0000-000000000020', 485000, 565000, 355000, 'Software Construction', 960, 'en', 2018, 'hardcover', '24 x 18 x 5 cm', 1200, true, true),
            (46, 'Intro to Algorithms', 'introduction-algorithms', '9780262033848', '50000000-0000-0000-0000-000000000014', '40000000-0000-0000-0000-000000000015', '30000000-0000-0000-0000-000000000020', 685000, 800000, 500000, 'CS textbook', 1312, 'en', 2018, 'hardcover', '25 x 20 x 7 cm', 1800, true, false),
            (47, 'Computer Networks', 'computer-networks', '9780132126953', '50000000-0000-0000-0000-000000000014', '40000000-0000-0000-0000-000000000010', '30000000-0000-0000-0000-000000000020', 565000, 660000, 415000, 'Network fundamentals', 960, 'en', 2017, 'hardcover', '24 x 18 x 5 cm', 1300, true, false),
            (48, 'OS Concepts', 'operating-system-concepts', '9781118063330', '50000000-0000-0000-0000-000000000014', '40000000-0000-0000-0000-000000000014', '30000000-0000-0000-0000-000000000020', 585000, 685000, 430000, 'Dinosaur book', 976, 'en', 2018, 'hardcover', '24 x 18 x 5.2 cm', 1350, true, false),
            (49, 'Hands-On ML', 'hands-on-machine-learning', '9781492032649', '50000000-0000-0000-0000-000000000015', '40000000-0000-0000-0000-000000000008', '30000000-0000-0000-0000-000000000021', 485000, 565000, 355000, 'Scikit-Learn Keras TensorFlow', 856, 'en', 2019, 'paperback', '23 x 17 x 4.5 cm', 1050, true, true),
            (50, 'Deep Learning', 'deep-learning', '9780262035613', '50000000-0000-0000-0000-000000000015', '40000000-0000-0000-0000-000000000015', '30000000-0000-0000-0000-000000000021', 685000, 800000, 500000, 'Adaptive Computation ML', 800, 'en', 2019, 'hardcover', '24 x 18 x 4.2 cm', 1100, true, true),
            (51, 'Python Crash', 'python-crash-course', '9781593279288', '50000000-0000-0000-0000-000000000015', '40000000-0000-0000-0000-000000000009', '30000000-0000-0000-0000-000000000020', 365000, 425000, 265000, 'Hands-On Python', 560, 'en', 2019, 'paperback', '23 x 16 x 3 cm', 650, true, true),
            (52, 'JS Good Parts', 'javascript-good-parts', '9780596517748', '50000000-0000-0000-0000-000000000015', '40000000-0000-0000-0000-000000000008', '30000000-0000-0000-0000-000000000022', 285000, 335000, 210000, 'Definitive JS guide', 176, 'en', 2018, 'paperback', '21 x 14 x 1 cm', 200, true, false),
            (53, 'You Dont Know JS', 'you-dont-know-js', '9781491904244', '50000000-0000-0000-0000-000000000015', '40000000-0000-0000-0000-000000000008', '30000000-0000-0000-0000-000000000022', 315000, 370000, 230000, 'Deep JavaScript', 278, 'en', 2019, 'paperback', '21 x 14 x 1.5 cm', 300, true, true),
            (54, 'Eloquent JS', 'eloquent-javascript', '9781593279509', '50000000-0000-0000-0000-000000000015', '40000000-0000-0000-0000-000000000009', '30000000-0000-0000-0000-000000000022', 365000, 425000, 265000, 'Modern JS Intro', 472, 'en', 2019, 'paperback', '23 x 16 x 2.5 cm', 550, true, false),
            (55, 'React Up Running', 'react-up-running', '9781491931820', '50000000-0000-0000-0000-000000000015', '40000000-0000-0000-0000-000000000008', '30000000-0000-0000-0000-000000000022', 335000, 390000, 245000, 'Building Web Apps', 222, 'en', 2018, 'paperback', '21 x 14 x 1.2 cm', 250, true, false),
            (56, 'Node Design Patterns', 'nodejs-design-patterns', '9781785885587', '50000000-0000-0000-0000-000000000015', '40000000-0000-0000-0000-000000000009', '30000000-0000-0000-0000-000000000022', 415000, 485000, 305000, 'Best practices', 526, 'en', 2019, 'paperback', '23 x 16 x 2.8 cm', 620, true, false),
            (57, 'Learning Go', 'learning-go', '9781492077213', '50000000-0000-0000-0000-000000000015', '40000000-0000-0000-0000-000000000008', '30000000-0000-0000-0000-000000000020', 385000, 450000, 280000, 'Idiomatic Go', 384, 'en', 2021, 'paperback', '23 x 16 x 2 cm', 450, true, true),
            (58, 'Kubernetes Up', 'kubernetes-up-running', '9781492046530', '50000000-0000-0000-0000-000000000015', '40000000-0000-0000-0000-000000000008', '30000000-0000-0000-0000-000000000024', 415000, 485000, 305000, 'Future Infrastructure', 318, 'en', 2020, 'paperback', '23 x 16 x 1.7 cm', 370, true, false),
            (59, 'Docker Deep Dive', 'docker-deep-dive', '9781521822807', '50000000-0000-0000-0000-000000000015', '40000000-0000-0000-0000-000000000009', '30000000-0000-0000-0000-000000000024', 365000, 425000, 265000, 'Zero to Docker', 310, 'en', 2020, 'paperback', '23 x 16 x 1.7 cm', 360, true, false),
            (60, 'Database Internals', 'database-internals', '9781492040347', '50000000-0000-0000-0000-000000000015', '40000000-0000-0000-0000-000000000008', '30000000-0000-0000-0000-000000000020', 465000, 545000, 340000, 'Distributed Data Systems', 373, 'en', 2019, 'paperback', '23 x 16 x 2 cm', 440, true, true)
        ) AS t(num, title, slug, isbn, author_id, publisher_id, category_id, price, compare_price, cost, description, pages, lang, year, format, dimensions, weight, active, featured)
    LOOP
        book_id := ('60000000-0000-0000-0000-0000000000' || LPAD(book_data.num::text, 2, '0'))::uuid;
        
        INSERT INTO books (
            id, title, slug, isbn,
            author_id, publisher_id, category_id,
            price, compare_at_price, cost_price,
            cover_url, images, description,
            pages, language, published_year, format, dimensions, weight_grams,
            is_active, is_featured,
            view_count, sold_count,
            meta_title, meta_description, meta_keywords,
            created_at, updated_at
        ) VALUES (
            book_id,
            book_data.title,
            book_data.slug,
            book_data.isbn,
            book_data.author_id::uuid,
            book_data.publisher_id::uuid,
            book_data.category_id::uuid,
            book_data.price,
            book_data.compare_price,
            book_data.cost,
            'https://cdn.bookstore.com/covers/' || book_data.slug || '.jpg',
            ARRAY['https://cdn.bookstore.com/books/' || book_data.slug || '-1.jpg', 'https://cdn.bookstore.com/books/' || book_data.slug || '-2.jpg'],
            book_data.description,
            book_data.pages,
            book_data.lang,
            book_data.year,
            book_data.format,
            book_data.dimensions,
            book_data.weight,
            book_data.active,
            book_data.featured,
            FLOOR(RANDOM() * 3000 + 500)::INT,  -- view_count
            FLOOR(RANDOM() * 800 + 100)::INT,    -- sold_count
            book_data.title || ' | Bookstore',
            'Mua sách ' || book_data.title || ' - ' || book_data.description,
            ARRAY[LOWER(book_data.title), 'sách', 'book'],
            NOW() - INTERVAL '2 years',
            NOW()
        );
    END LOOP;
END $$;
